jQuery(document).on("dragstart",".attachments-browser .attachments .attachment",function(e){jQuery(".uploader-window").css("visibility","hidden"),allIDS=[],jQuery(".attachments-browser .attachments .attachment[aria-checked='true']").length>0?(jQuery(".attachments-browser .attachments .attachment[aria-checked='true']").each(function(e){tempid=jQuery(this).attr("data-id"),allIDS.push(tempid)}),e.originalEvent.dataTransfer.setData("itemID",JSON.stringify(allIDS))):(theid=jQuery(e.currentTarget).attr("data-id"),e.originalEvent.dataTransfer.setData("itemID",JSON.stringify([theid]))),thefiles="1 file",e.originalEvent.dataTransfer.dropEffect="move",e.originalEvent.dataTransfer.effectAllowed="move",e.originalEvent.dataTransfer.setData("type","content"),jQuery("#a2020-folder-template").show();var t=document.createElement("div");t.id="a2020Contentdrag",t.innerHTML=thefiles,t.style.position="absolute",t.style.top="-1000px",document.body.appendChild(t),e.originalEvent.dataTransfer.setDragImage(t,0,0)});const a2020folders={data:()=>({loading:!0,folders:{allFolders:[],openFolders:[],activeFolder:[],activeFolderObj:[],newFolder:{name:"",color:"#0c5cef",parent:""},editFolder:{name:"",color:"",id:""}}}),computed:{queryContent(){this.getFolders()},queryTheFolders(){return this.queryContent,this.folders.allFolders}},mounted:function(){},watch:{},methods:{getFolders(){self=this,this.loading=!0,jQuery.ajax({url:admin2020_folder_ajax.ajax_url,type:"post",data:{action:"a2020_get_folders_legacy",security:admin2020_folder_ajax.security},success:function(e){if(data=JSON.parse(e),self.loading=!1,data)return self.folders.allFolders=data,self.folders.allFolders}})},createFolder(){self=this,self.loading=!0,self.folders.newFolder.parent=self.folders.activeFolder[0],folders=self.folders.newFolder,jQuery.ajax({url:admin2020_folder_ajax.ajax_url,type:"post",data:{action:"a2020_create_folder_legacy",security:admin2020_folder_ajax.security,folders:folders},success:function(e){if(self.loading=!1,data=JSON.parse(e),!data.error)return data?(UIkit.notification(data.message,{pos:"bottom-left",status:"success"}),self.folders.newFolder.name="",self.folders.newFolder.parent="",self.getFolders()):void 0;UIkit.notification(data.error,{pos:"bottom-left",status:"danger"})}})},confirmDeleteFolder(){self=this,UIkit.modal.confirm("Are you sure you want to delete this folder?").then(function(){self.deleteFolder()},function(){})},viewAllMediaWithoutFolder(){this.folders.activeFolder=["uncat"],wp.media.frame.content.get().collection.props.set({folder_id:"uncat"})},viewAllMedia(){this.folders.activeFolder=[],wp.media.frame.content.get().collection.props.set({folder_id:""})},editFolder(e){self=this,self.folders.editFolder.name=e.title,self.folders.editFolder.color=e.color,self.folders.editFolder.id=e.id,jQuery("#updatefolderpanel").show()},updateFolder(){self=this,thefolder=self.folders.editFolder,jQuery.ajax({url:admin2020_folder_ajax.ajax_url,type:"post",data:{action:"a2020_update_folder_legacy",security:admin2020_folder_ajax.security,thefolder:thefolder},success:function(e){if(self.loading=!1,data=JSON.parse(e),!data.error)return data?(UIkit.notification(data.message,{pos:"bottom-left",status:"success"}),jQuery("#updatefolderpanel").hide(),self.getFolders()):void 0;UIkit.notification(data.error,{pos:"bottom-left",status:"danger"})}})},deleteFolder(){self=this,self.loading=!0,activeFolder=self.folders.activeFolder[0],jQuery.ajax({url:admin2020_folder_ajax.ajax_url,type:"post",data:{action:"a2020_delete_folder_legacy",security:admin2020_folder_ajax.security,activeFolder:activeFolder},success:function(e){if(self.loading=!1,data=JSON.parse(e),!data.error)return data?(UIkit.notification(data.message,{pos:"bottom-left",status:"success"}),self.folders.activeFolder=[],self.getFolders()):void 0;UIkit.notification(data.error,{pos:"bottom-left",status:"danger"})}})},dropInTopLevel(e){var t=e.dataTransfer.getData("itemID"),a=e.dataTransfer.getData("type");"folder"==a&&this.moveFolder(t,"toplevel"),"content"==a&&this.moveContentToFolder(JSON.parse(t),"toplevel"),jQuery("#a2020-folder-template").hide()},moveContentToFolder(e,t){self=this,jQuery.ajax({url:admin2020_folder_ajax.ajax_url,type:"post",data:{action:"a2020_move_content_to_folder_legacy",security:admin2020_folder_ajax.security,contentID:e,destinationId:t},success:function(e){if(data=JSON.parse(e),!data.error)return UIkit.notification(data.message,{pos:"bottom-left",status:"succes"}),self.getFolders();UIkit.notification(data.error,{pos:"bottom-left",status:"danger"})}})},moveFolder(e,t){self=this,jQuery.ajax({url:admin2020_folder_ajax.ajax_url,type:"post",data:{action:"a2020_move_folder_legacy",security:admin2020_folder_ajax.security,folderiD:e,destinationId:t},success:function(e){if(data=JSON.parse(e),!data.error)return UIkit.notification(data.message,{pos:"bottom-left",status:"success"}),self.getFolders();UIkit.notification(data.error,{pos:"bottom-left",status:"danger"})}})},startContentDrag(e,t){allSelected=this.contentTable.selected,allSelected.length>0?(e.dataTransfer.setData("itemID",JSON.stringify(allSelected)),thefiles=allSelected.length+" files"):(e.dataTransfer.setData("itemID",JSON.stringify([t.id])),thefiles="1 file"),e.dataTransfer.dropEffect="move",e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("type","content"),jQuery("#a2020-folder-template").show();var a=document.createElement("div");a.id="a2020Contentdrag",a.innerHTML=thefiles,a.style.position="absolute",a.style.top="-1000px",document.body.appendChild(a),e.dataTransfer.setDragImage(a,0,0)},endContentDrag(e,t){jQuery("#a2020-folder-template").hide()},isIn:(e,t)=>t.includes(e),removeFromList(e,t){const a=t.indexOf(e);a>-1&&(t=t.splice(a,1))}}},a2020foldersapp=a2020Vue.createApp(a2020folders);a2020foldersapp.component("folder-template",{props:{folder:Object,open:Array,current:Array},data:function(){return{currentFolderObject:[],dragCounter:0,currentFrame:""}},methods:{isIn(e){return this.open.includes(e)},isActive(e){return this.current.includes(e)},folderToggle(e){const t=this.open.indexOf(e);t>-1?options=this.open.splice(t,1):this.open.push(e)},makeActive(e,t){t[0]=e.id,self=this,wp.media.frames.browse?wp.media.frames.browse.content.get().collection.props.set({folder_id:e.id}):wp.media.frame.content.get().collection.props.set({folder_id:e.id})},editFolder(e){this.$parent.editFolder(e)},moveFolder(e,t){self=this,this.dragCounter=0,jQuery.ajax({url:admin2020_folder_ajax.ajax_url,type:"post",data:{action:"a2020_move_folder_legacy",security:admin2020_folder_ajax.security,folderiD:e,destinationId:t},success:function(e){if(data=JSON.parse(e),!data.error)return UIkit.notification(data.message,{pos:"bottom-left",status:"succes"}),self.refreshFolders();UIkit.notification(data.error,{pos:"bottom-left",status:"danger"})}})},moveContentToFolder(e,t){self=this,this.dragCounter=0,theids=JSON.parse(e),jQuery.ajax({url:admin2020_folder_ajax.ajax_url,type:"post",data:{action:"a2020_move_content_to_folder_legacy",security:admin2020_folder_ajax.security,contentID:theids,destinationId:t},success:function(e){data=JSON.parse(e),data.error?UIkit.notification(data.error,{pos:"bottom-left",status:"danger"}):(UIkit.notification(data.message,{pos:"bottom-left",status:"succes"}),self.$root.getFolders())}})},refreshFolders(){this.$root.getFolders()},startFolderDrag(e,t){e.dataTransfer.dropEffect="move",e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("itemID",t.id),e.dataTransfer.setData("type","folder"),jQuery("#a2020-folder-template").show(),jQuery(".uploader-window").remove()},dropInfolder(e,t){this.dragCounter=0;var a=e.dataTransfer.getData("itemID"),r=e.dataTransfer.getData("type");"folder"==r&&this.moveFolder(a,t.id),"content"==r&&this.moveContentToFolder(a,JSON.parse(t.id)),jQuery(".valid_drop").removeClass("valid_drop"),jQuery("#a2020-folder-template").hide()},addDropClass(e,t){e.preventDefault(),target=e.target,this.dragCounter++,jQuery(target).hasClass("folder_block")?jQuery(target).addClass("valid_drop"):jQuery(target).closest(".folder_block").addClass("valid_drop")},removeDropClass(e,t){e.preventDefault(),target=e.target,this.dragCounter--,0==this.dragCounter&&(jQuery(target).hasClass("folder_block")?jQuery(target).removeClass("valid_drop"):jQuery(target).closest(".folder_block").removeClass("valid_drop"))}},template:'<div class="a2020-folder-component "  :data-folder-id="folder.id">      <div class="uk-flex uk-flex-middle folder_block" draggable="true"      @dragstart="startFolderDrag($event,folder)"      @drop="dropInfolder($event, folder)"       @dragenter="addDropClass($event, folder)"      @dragleave="removeDropClass($event, folder)"      @dragover.prevent      @dragenter.prevent       :class="[{\'folder_open\' : isIn(folder.id)}, {\'active-folder\' : isActive(folder.id)} ]">        <span class="material-icons-outlined uk-text-muted folderChevron" :class="{\'nosub\' : !folder.hasOwnProperty(\'subs\')}" @click="folderToggle(folder.id)">          chevron_right        </span>        <span class="uk-flex uk-flex-middle folder-click" @click="makeActive(folder,current)">          <span class="material-icons  uk-margin-small-right " :style="{\'color\': folder.color}">folder</span>          <span class=" uk-text-bold">{{folder.title}}</span>        </span>        <span class="material-icons  uk-margin-small-left a2020-folder-edit"  @click="editFolder(folder)">edit</span>        <span class="uk-text-muted uk-text-bold a2020-folder-count">{{folder.count}}</span>      </div>      <template v-if="folder.subs" >        <div class="a2020-folder-sub" v-if="isIn(folder.id)">          <template v-for="subfolder in folder.subs">            <folder-template :folder="subfolder" :open="open" :current="current" ></folder-template>          </template>        </div>      </template>    </div>    '});